# cron：定期実行の守護神だにゃ

cronは、Linuxシステムにおいて「指定した時間に特定のコマンドを自動実行させる」ための常駐プログラム（デーモン）だにゃ。

---

## 1. 設定の書き方（crontabの書式）だにゃ

cronの設定は、以下の5つのフィールド（日時指定）と、実行するコマンドの組み合わせで記述するにゃ。

```text
m h dom mon dow command

```

| フィールド | 意味 | 範囲 |
| --- | --- | --- |
| **m** | 分 (minute) | 0 - 59 |
| **h** | 時 (hour) | 0 - 23 |
| **dom** | 日 (day of month) | 1 - 31 |
| **mon** | 月 (month) | 1 - 12 |
| **dow** | 曜日 (day of week) | 0 - 7 (0, 7は日曜日) |

---

## 2. 具体的な使用例（スケジュール発散編）だにゃ

「具体的にどう書くとどう動くのか」のバリエーションを5つ紹介するにゃ。

### ① 毎日決まった時間に実行（深夜の掃除）

```bash
30 3 * * * /usr/bin/apt-get clean

```

* **動作**: 毎日 **午前3時30分** に実行。
* **用途**: サーバーが空いている深夜に、キャッシュの削除やログのローテーションをするのによく使われるにゃ。

### ② 特定の曜日だけ実行（週末のフルバックアップ）

```bash
0 2 * * 0 /home/user/scripts/full-backup.sh

```

* **動作**: 毎週 **日曜日（0）の午前2時0分** に実行。
* **用途**: 月〜土は差分だけ、日曜日は全部バックアップ、みたいな運用に最適だにゃ。

### ③ 一定の間隔で実行（死活監視）

```bash
*/15 * * * * /usr/bin/curl -s https://example.com > /dev/null

```

* **動作**: **15分ごと**（0, 15, 30, 45分）に実行。
* **用途**: サイトが落ちていないか定期的にチェックしたり、センサーのデータを取得したりする時に使うにゃ。

### ④ 複数の時間を指定（出退勤ログなど）

```bash
0 9,18 * * 1-5 /home/user/scripts/poker-bell.sh

```

* **動作**: **月曜日から金曜日（1-5）** の、**午前9時と午後18時** に実行。
* **用途**: 仕事の開始と終了のタイミングだけ通知を飛ばしたい時に便利だにゃ。

### ⑤ 毎月1日だけ実行（月次レポート）

```bash
0 0 1 * * /home/user/scripts/monthly-report.sh

```

* **動作**: **毎月1日の午前0時0分** に実行。
* **用途**: 先月の集計データを作成したり、月額の更新処理をしたりする時に使うにゃ。

---

## 3. 注意事項だにゃ

* **絶対パスの原則**: cronはシェル環境（PATH）を引き継がないから、コマンドは必ず `/usr/bin/curl` のように **絶対パス** で書かないと動かないにゃ。
* **リダイレクト**: `2>&1` は「エラーも標準出力と同じログへ送る」という意味だにゃ。
* **編集コマンド**: 実際に設定をいじるときはターミナルで `crontab -e` と打つにゃ。

---

## 4. 参考URLだにゃ

* **Man page of CRONTAB(5)** (Ubuntu公式マニュアル)
[https://manpages.ubuntu.com/manpages/jammy/ja/man5/crontab.5.html](https://manpages.ubuntu.com/manpages/jammy/ja/man5/crontab.5.html)
* **GNU ソフトウェア - mcron** (自由ソフトウェア財団)
[https://www.gnu.org/software/mcron/](https://www.gnu.org/software/mcron/)
